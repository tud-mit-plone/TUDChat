<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="contact">

<body>
<metal:javascriptslot fill-slot="javascript_head_slot">
  <script type="text/javascript" src="jquery-1.7.min.js"></script>
  <script type="text/javascript" src="jquery-ui-1.8.19.custom.min.js"></script>
  <script type="text/javascript" src="jquery-ui-timepicker-addon.js"></script>
  <script type="text/javascript" src="jquery.ui.datepicker-de.js"></script>

  <script language="javascript">

    $(document).ready(
        function(){
          $('#sessions tr:odd').css('background-color', '#eee');
        }
    );


  </script>

</metal:javascriptslot>

<metal:cssslot fill-slot="style_slot">
  <link rel="stylesheet" href="jquery-ui-timepicker-addon.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="tud_chat_css/ui-lightness/jquery-ui-1.8.19.custom.css" type="text/css" media="screen" />

  <style type="text/css">
  <!--
    #sessions th, #sessions td {
      text-align:center;
      padding: 0 5px;
    }
    #sessions tr td:first-child + td {
      text-align:left;
    }

    #sessions .info {
      font-style: italic;
      color: #555;
    }

  -->
  </style>


</metal:cssslot>

<metal:main fill-slot="main" tal:define="errors request/errors|python:{};
                                         here_url context/@@plone_context_state/object_url">

        <h1>Chat-Sitzungen verwalten</h1>

<form tal:attributes="action string:${here_url}/editSessionsSubmit" name="form" method="post">

  <div class="field">
    <table width="100%" id='sessions'>
      <tr>
        <th></th>
        <th>Status</th>
        <th>Titel</th>
        <th>Passwort</th>
        <th>maximale Benutzer</th>
        <th>Startzeit</th>
        <th>Endzeit</th>
        <th>Protokoll</th>
        <th>Bearbeiten</th>
      </tr>
      <tr tal:repeat="session python: here.getAllChatSessions(context.REQUEST)">
        <td>
          <input tal:condition="not:session/active" type="checkbox" name="delete:list:int" tal:attributes="value session/id"/>
        </td>
        <td>
          <span tal:replace="session/status"/>
        </td>
        <td>
          <span tal:replace="session/name"/>
        </td>
        <td>
          <tal:value condition="session/password" replace="session/password" />
          <tal:Altvalue condition="not:session/password">
            <span class="info" tal:content="string:Keine Passwort gesetzt" />
          </tal:Altvalue>
        </td>
        <td>
          <tal:value condition="session/max_users" replace="session/max_users" />
          <tal:Altvalue condition="not:session/max_users">
            <span class="info" tal:content="string:Keine Begrenzung" />
          </tal:Altvalue>
        </td>
        <td>
          <span tal:replace="python:session.get('start').strftime('%d.%m.%Y, %H:%M Uhr')"/>
        </td>
        <td>
          <span tal:replace="python:session.get('end').strftime('%d.%m.%Y, %H:%M Uhr')"/>
        </td>
        <td>
          <a tal:condition="session/locked" tal:attributes="href python:context.id + '/TUDChat_log?chat_uid='+str(session.get('id'))">Log ansehen</a>
        </td>
        <td>
          <a tal:condition="not: session/locked" tal:attributes="href python:context.id + '/edit_session?chat_uid='+str(session.get('id'))">Bearbeiten</a>
        </td>
      </tr>
    </table>
  </div>

  <div class="formControls">
    <input type="hidden" name="form.submitted" value="1" />
    <input class="context" type="submit" id="save" name="form.button.Delete" value="Ausgew&auml;hlte Chat-Sitzungen l&ouml;schen" />
  </div>

</form>

</metal:main>

<metal:bottom fill-slot="bottom">
  <div class="documentBottomLine">
    <div metal:use-macro="here/document_byline/macros/byline">
        Get the byline - contains details about author and modification date.
    </div>
    <div metal:use-macro="here/document_actions/macros/document_actions">
        Document actions (print, sendto etc)
    </div>
    <br class="floatclearer" />
  </div>
</metal:bottom>

</body>
</html>
