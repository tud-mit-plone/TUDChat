<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
  metal:use-macro="here/main_template/macros/master" i18n:domain="plone">
<head>

<metal:javascriptslot fill-slot="javascript_head_slot">

  <script language="javascript">

    $(document).ready(
        function(){
          $('#logtable tr:odd, #infotable tr:odd').css('background-color', '#eee');
        }
    );


  </script>

</metal:javascriptslot>

<metal:block metal:fill-slot="css_slot">
  <style type="text/css">
  <!--
    #infotable th, #infotable td {
      padding: 0 5px;
    }

    #infotable td:first-child {
      padding-right: 15px;
    }

    #infotable .info {
      font-style: italic;
      color: #555;
    }

    #logtable {
      width: 100%;
      margin-top: 20px;
      margin-bottom: 20px;
    }

    #logtable th {
      text-align:center;
    }
    #logtable td {
      padding: 0 5px;
    }

    #logtable th.column_id {
      width: 3%;
    }

    #logtable th.column_time {
      width: 10%;
    }

    #logtable th.column_name {
      width: 8%;
    }

    #logtable td.column_id, #logtable td.column_time, #logtable td.column_name {
      text-align: center;
    }


  -->
  </style>
</metal:block>

</head>

<body metal:fill-slot="main" i18n:domain="tudchat"
      tal:define="chat_uid python: request.get('chat_uid');
                  session_info python: here.getChatSessionInfo(chat_uid);
                  log python: here.getLogs(chat_uid)">

<h1>Chat-Log</h1>
<table id="infotable">
    <tr>
      <th colspan="2">
        Informationen zur Sitzung:
      </th>
    </tr>
    <tr>
      <td>Chat-ID</td>
      <td tal:content="session_info/id"></td>
    </tr>
    <tr>
      <td>Name</td>
      <td tal:content="session_info/name"></td>
    </tr>
    <tr>
      <td>Beschreibung</td>
      <td tal:content="session_info/description"></td>
    </tr>
    <tr>
      <td>Passwort</td>
      <td>
        <tal:value condition="session_info/password" replace="session_info/password" />
        <tal:Altvalue condition="not:session_info/password">
          <span class="info" tal:content="string:Keine Passwort gesetzt" />
        </tal:Altvalue>
      </td>
    </tr>
    <tr>
      <td>maximale Benutzer</td>
      <td>
        <tal:value condition="session_info/max_users" replace="session_info/max_users" />
        <tal:Altvalue condition="not:session_info/max_users">
          <span class="info" tal:content="string:Keine Begrenzung" />
        </tal:Altvalue>
      </td>
    </tr>
    <tr>
      <td>Startzeit</td>
      <td tal:content="session_info/start"></td>
    </tr>
    <tr>
      <td>Endzeit</td>
      <td tal:content="session_info/end"></td>
    </tr>
</table>

<table id="logtable">
  <thead>
    <th class="column_id">ID</th>
    <th class="column_time">Zeit</th>
    <th class="column_name">Name</th>
    <th class="column_message">Nachricht</th>
  </thead>
  <tbody>
    <tr tal:repeat="message log">
      <td class="column_id" tal:content="message/id"></td>
      <td class="column_time" tal:content="python: message['date'].strftime('%d.%m.%Y, %H:%M:%S Uhr')"></td>
      <td class="column_name" tal:content="message/user"></td>
      <td class="column_message" tal:content="message/message"></td>
    </tr>
  </tbody>
</table>

</body>
</html>
